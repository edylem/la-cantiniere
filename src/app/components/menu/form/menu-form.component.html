<p-dialog
  [(visible)]="visible"
  (onShow)="initEditedMenuGroup()"
  (visibleChange)="visibleChange.emit($event)"
  [modal]="true"
  [style]="{ width: '500px' }"
  [header]="'Modifier le menu'"
  [dismissableMask]="true"
>
  @if (editedMenuGroup) {
    <div class="flex flex-column gap-3">
      <!-- Date -->
      <div>
        <label for="menuDate">Date de début</label>
        <p-datepicker
          id="menuDate"
          [(ngModel)]="editedMenuGroup.date"
          [showIcon]="true"
          dateFormat="dd/mm/yy"
          class="w-full"
        ></p-datepicker>
      </div>

      <!-- Liste des menus -->
      <div class="menus-section">
        <div class="menu-header">
          <label>Repas</label>
          <span class="cooked-label">Cuisiné</span>
        </div>
        <div class="menu-items">
          @for (menu of editedMenuGroup.menus; track menu.num) {
            <div class="menu-row" [class.empty]="!menu.recipeId">
              <span class="menu-num">{{ menu.num }}.</span>
              <span class="menu-title flex-1">{{ getRecipeTitle(menu.recipeId) }}</span>
              @if (menu.recipeId) {
                <p-checkbox
                  [(ngModel)]="menu.done"
                  [binary]="true"
                ></p-checkbox>
                <button
                  pButton
                  type="button"
                  icon="pi pi-times"
                  class="p-button-danger p-button-text p-button-sm"
                  (click)="removeRecipe(menu)"
                  title="Retirer du menu"
                ></button>
              }
            </div>
          }
        </div>
      </div>

      <!-- Boutons -->
      <div class="flex gap-2 justify-content-end mt-3 pt-3 border-top-1 surface-border">
        <button pButton label="Annuler" class="p-button-text" (click)="onCancel()"></button>
        <button pButton label="Enregistrer" (click)="onSave()"></button>
      </div>
    </div>
  }
</p-dialog>
